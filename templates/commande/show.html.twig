{% extends 'base.html.twig' %}

{% block title %}Commande{% endblock %}

{% block body %}
<div class="row align-items-center justify-content-center">
    <img class="col-3" src="{{ asset('img/separator.svg') }}">
    <h1 class="text-center" >Panier</h1>
    <img class="col-3" src="{{ asset('img/separator.svg') }}">
</div>
    <table class="table">
        <thead>
        <tr>
            <th>Produit</th>

            <th>Modifier</th>

            <th>Statut</th>
            <th>Quantite</th>
            <th>Prix Unitaire</th>
            <th>Total</th>
        </tr>
        </thead>
        <tbody>
        {% for ligne in lignes %}
            <tr>
                <td>{{ ligne.idProduit }} - {{ ligne.idProduit.denomination }}</td>

                <td>
                    {% if ligne.idCommande.idStatut == 'En attente de validation'%}
                    <a class="btn " href="{{ path('app_ligne_edit' , {'id': ligne.id}) }}">Modifier</a>
                        {% else %}
                        Commande Validé
                    {% endif  %}


                </td>
                <td>{{ ligne.idStatut }}</td>
                <td>{{ ligne.quantite }}</td>
                <td>{{ ligne.idProduit.prixUnitaire }}</td>
                <td>{{ ligne.quantite * ligne.idproduit.prixUnitaire }} €</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="3">no records found</td>
            </tr>
        {% endfor %}

        <tfoot>
        <tr>
            <td >
            </td>
            <td >
            </td>
            <td >
            </td>
            <td >
            </td>
            <td >
                TOTAL HT
            </td>
            <td >
                {% set sum = 0 %}
                {% for ligne in lignes %}

                    {%  set sum = sum + (ligne.quantite * ligne.idproduit.prixUnitaire)  %}

                {% endfor %}
                {{ sum }} €

            </td>
        </tr>
        <tr>
            <td>
            </td>
            <td >
            </td>
            <td >
            </td>
            <td >
            </td>
            <td >
                TAXE à  20%
            </td>
            <td>
                {{ sum *0.2}} €
            </td>
        </tr>
        <tr>
            <td>
            </td>
            <td >
            </td>
            <td >
            <td >
            </td>
            </td>
            <td >
                TOTAL TTC À PAYER
            </td>
            <td>
                 {{ sum *1.2}} €
            </td>
        </tr>
        </tfoot>
        </tbody>
    </table>



{% if commande.idStatut.id == 4 %}
    <a class="btn btn-success m-3" href="{{ path('app_commande_valide' , {'id': commande.id}) }}">Valider</a>

    {{ include('commande/_delete_form.html.twig') }}
    {% endif %}


{% endblock %}
